define("discourse/plugins/discourse-tooltips/discourse/lib/event-from",["exports"],(function(e){"use strict";function t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var o=[],n=!0,i=!1,r=void 0;try{for(var s,u=e[Symbol.iterator]();!(n=(s=u.next()).done)&&(o.push(s.value),!t||o.length!==t);n=!0);}catch(e){i=!0,r=e}finally{try{n||null==u.return||u.return()}finally{if(i)throw r}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}Object.defineProperty(e,"__esModule",{value:!0}),e.setEventFrom=e.eventFrom=void 0;var n,i,r,s="key",u=s,c=!1,a=!1,d=!1,l=function(e){c=!0,s="touch",window.clearTimeout(n),n=window.setTimeout((function(){c=!1}),e)},p=function(){a=!0,s="mouse",window.clearTimeout(i),i=window.setTimeout((function(){a=!1}),200)},f=function(e){return function(){return l(e)}},m=function(e){return function(t){switch(t.pointerType){case"mouse":p();break;case"pen":case"touch":l(e)}}},v=function(){c||p()},h=function(){s="key"},y={capture:!0,passive:!0},w=[["touchstart",f(750)],["touchend",f(300)],["touchcancel",f(300)],["pointerenter",m(300)],["pointerover",m(300)],["pointerout",m(300)],["pointerleave",m(300)],["pointerdown",m(750)],["pointerup",m(300)],["pointercancel",m(300)],["mouseenter",v],["mouseover",v],["mouseout",v],["mouseleave",v],["mousedown",v],["mouseup",v],["keydown",h],["keyup",h],["focus",function(){(!d||a||c)&&(u=s)}]];"undefined"!=typeof window&&"undefined"!=typeof document&&(w.forEach((function(e){var o=t(e,2),n=o[0],i=o[1];document.addEventListener(n,i,y)})),window.addEventListener("focus",(function(e){e.target!==window&&e.target!==document||(d=!0,window.clearTimeout(r),r=window.setTimeout((function(){d=!1}),300))}),y));e.setEventFrom=function(e){if("production"!==process.env.NODE_ENV&&"mouse"!==e&&"touch"!==e&&"key"!==e)throw Error('setEventFrom function requires argument of "mouse" | "touch" | "key", argument received: '.concat(e));"mouse"!==e&&"touch"!==e&&"key"!==e||(s=e,u=e)};e.eventFrom=function(e){switch(e.pointerType){case"mouse":p();break;case"pen":case"touch":c?s="touch":l(300)}return/mouse/.test(e.type)&&!c&&p(),/touch/.test(e.type)&&(c?s="touch":l(300)),/focus/.test(e.type)?u:s}})),define("discourse/plugins/discourse-tooltips/initializers/attach-hover-event",["exports","discourse/lib/plugin-api","discourse/plugins/discourse-tooltips/mixins/topic-hover-extension"],(function(e,t,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={name:"attach-hover-event",initialize:function(){(0,t.withPluginApi)("0.8.9",(function(e){e.modifyClass("component:topic-list",(0,o.hoverExtension)(".raw-topic-link")),e.modifyClass("component:categories-topic-list",(0,o.hoverExtension)(".main-link a.title"))}))}};e.default=n})),define("discourse/plugins/discourse-tooltips/mixins/topic-hover-extension",["exports","discourse/lib/ajax","discourse-common/lib/object","discourse/plugins/discourse-tooltips/discourse/lib/event-from"],(function(e,t,o,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.hoverExtension=function(e){return{pluginId:"discourse-tooltips",didInsertElement:function(){this._super.apply(this,arguments),c(),$(this.element).on("mouseenter.discourse-tooltips",e,(function(e){var u=this;if("mouse"===(0,n.eventFrom)(e)){var l=$(this),p=$(e.currentTarget);void 0===p.attr("data-topic-id")&&(p=p.parents("[data-topic-id]").last());var f=parseInt(p.attr("data-topic-id"),10);if(f){if(c(),s=!0,r[f])return a(l,r[f].excerpt);if(d)return;var m=[f];p.nextAll("[data-topic-id]:lt(".concat(4,")")).each((function(e,t){var o=parseInt(t.getAttribute("data-topic-id"),10);r[o]||m.push(o)})),(i=(0,t.ajax)("/tooltip-previews",{data:{topic_ids:m},cache:!0})).then((function(e){e&&e.excerpts&&(0,o.deepMerge)(r,e.excerpts),s&&a(l,r[f].excerpt)})).catch((function(e){var t=e.jqXHR;if(t&&429===t.status){d=!0;var o=parseInt(t.getResponseHeader&&t.getResponseHeader("Retry-After"),10)||0;(o=o||0)<15&&(o=15),u.rateLimiter=Ember.run.later(u,(function(){d=!1}),1e3*o)}}))}}})),$(this.element).on("mouseleave.discourse-tooltips",e,(function(e){"mouse"===(0,n.eventFrom)(e)&&u()}))},willDestroyElement:function(){Ember.run.cancel(this.rateLimiter),d=!1,this._super.apply(this,arguments),c(),$(this.element).find(e).off("mouseenter.discourse-tooltips, mouseleave.discourse-tooltips",e)}}};var i,r={},s=!1;function u(){$(".d-tooltip").remove(),s=!1}function c(){i&&(i.abort(),i=null),u()}function a(e,t){e.after("<div class='d-tooltip'><div class='d-tooltip-pointer'></div><div class='d-tooltip-content'>".concat(t,"</div></div></div>"));var o=$(".d-tooltip"),n=o.outerWidth(),i=e.width(),r=e.height(),s=e.position(),u=s.left,c=s.top+r,a=u+i/2-n/2;(e.hasClass("main-link")?e:e.parents(".main-link")).offset().left+a<0&&(a=u),o.css({left:"".concat(a,"px"),top:"".concat(c,"px")}),o.fadeIn(200)}var d=!1}));
//# sourceMappingURL=discourse-tooltips-c2d944a259b1e86791b6f6b37b468e1a8028471d95419ae1d2a76b07bc7ed432.js.map